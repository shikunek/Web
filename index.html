<html>
<head>
  <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>


	<h1 id="B"></h1>

<!-- <header id="header">
  <div class="inner">
    <nav id="menubar">
    <ul id="menu">
        <li class="dropdown"><a href="#">Company</a></li>
        <li class="selected dropdown"><a href="#">Products</a></li>
        <li class="dropdown"><a href="#">News</a></li>
        <li class="dropdown"><a href="#">Downloads</a></li>
        <li><a href="#">Contact</a></li>
    </ul>
    </nav>
  </div>
</header> -->


<!-- <section id="graph">
  <img src="graph.png" alt="Browser GUI" width="600">

</section> -->

<div id="top">
    <div class="login">
        
        <div id="username">
          <label><b>Username</b></label>
          <input type="text" placeholder="Enter Username" id="email" required>
        </div>
        
        <div id="password">
          <label><b>Password</b></label>
          <input type="password" placeholder="Enter Password" id="psw" required>
        </div>
        
        <div id="loginButtons">
          <button type="submit" id="signIn" onClick="signIn()">Sign In</button>
          <button type="submit" id="siqnUp" onClick="signUp()">Sign Up</button>
        </div>

        
    </div>



    <!-- <div id="usersTable">

        <table id="myTable">

            <tr>

              <td>Row1 cell1</td>
              <td>Row1 cell2</td>

            </tr>

        </table>  

    </div>
 -->
</div>

<!-- <div>
  <div id="smiles">
    <form action="">
        <input type="radio" name="gender" value="1"> Excelent<br>
        <input type="radio" name="gender" value="0"> Good<br>
        <input type="radio" name="gender" value="-1"> Bad
    </form>
  </div>
  
  <div>
    <button type="submit" id="send" onClick="sendProgress()">Send</button>
  </div>
  
</div> -->

<!-- <canvas id="myChart" width="400" height="400"></canvas> -->


<script src="basicFunction.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.3.0/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyAR7L3KrsOWXYqu0HMcM85EOBPKWSOF9t0",
    authDomain: "testapp-5cce5.firebaseapp.com",
    databaseURL: "https://testapp-5cce5.firebaseio.com",
    projectId: "testapp-5cce5",
    storageBucket: "",
    messagingSenderId: "984038814608"
  };
  firebase.initializeApp(config);

  var B = document.getElementById('B');
  var dbref = firebase.database().ref().child('text');
  
  dbref.on('value', snap => B.innerText = snap.val());

    function signUp() {

     var username = document.getElementById("email").value;
     var password = document.getElementById("psw").value;
     firebase.auth().createUserWithEmailAndPassword(username, password).catch(function(error) {
        // Handle Errors here.
        var errorCode = error.code;
        var errorMessage = error.message;
        // [START_EXCLUDE]
        if (errorCode == 'auth/weak-password') {
          alert('The password is too weak.');
        } else {
          alert(errorMessage);
        }
        console.log(error);
        // [END_EXCLUDE]
      });

           //Handle Account Status
      firebase.auth().onAuthStateChanged(user => {
        if(user) {
          window.location = 'graph.html'; //After successful login, user will be redirected to home.html
        }
      });
    
  }

  function signIn() {
      if (firebase.auth().currentUser) {
        // [START signout]
        console.log(firebase.auth().currentUser.email);
        firebase.auth().signOut();
        // [END signout]
      } 
      {
        var email = document.getElementById('email').value;
        var password = document.getElementById('psw').value;
        if (email.length < 4) {
          alert('Please enter an email address.');
          return;
        }
        if (password.length < 4) {
          alert('Please enter a password.');
          return;
        }
        // Sign in with email and pass.
        // [START authwithemail]
        var result = firebase.auth().signInWithEmailAndPassword(email, password).catch(function(error) {
          // Handle Errors here.
          var errorCode = error.code;
          var errorMessage = error.message;
          // [START_EXCLUDE]
          if (errorCode === 'auth/wrong-password') {
            alert('Wrong password.');
          } else {
            alert(errorMessage);
          }
          console.log(error);
          

          // [END_EXCLUDE]
        });
        
        
        // [END authwithemail]
      }
      
      //Handle Account Status
      firebase.auth().onAuthStateChanged(user => {
        if(user) {
          window.location = 'graph.html'; //After successful login, user will be redirected to home.html
        }
      });
      
    }

    // var table = document.getElementById("myTable");

    //   var newUserRef = firebase.database().ref('Users/');
    //   newUserRef.on('child_added', function(data) {
    //     console.log(data.val());
    //       var row = table.insertRow(0);
    //       var cell1 = row.insertCell(0);
    //       var cell2 = row.insertCell(1);
    //       cell1.innerHTML = data.val().name;
    //       cell2.innerHTML = data.val().age;
    //   });

  function addUsers()
  {
      
      var userName = document.getElementById("name").value;
      var userAge = document.getElementById("age").value;      

      var newID = firebase.database().ref().child('Users').push().key;
      var updates = {};
      var postData = {
                name : userName,
                age : userAge
              };
      updates['/Users/' + newID] = postData;

      firebase.database().ref().update(updates);


            //   firebase.database().ref("Users").update({
        //     [userName] : {
        //         age : userAge
        //       }
        // });

  }

  function sendProgress()
  {
      
      firebase.database().ref('/Progress/' + 'Petr').once('value').then(function(snapshot) {
        var old_X = snapshot.val().X;
        var new_X = parseInt($('input[name="gender"]:checked').val()) + parseInt(old_X);
        var newProgress = firebase.database().ref().child('Progress').push().key;
        var updates = {};
        var postData = {
                  X : new_X,
                  Y : new_X
                };
        updates['/Progress/' + 'Petr'] = postData;

        firebase.database().ref().update(updates);
      });
      
      
  }

// var ctx = document.getElementById("myChart");

// var myLineChart = new Chart(ctx, {
//     type: 'line',
//     data: {
//             labels: ["January", "February", "March", "April", "May", "June", "July"],
//                       datasets: [{
//                           label: "My First dataset",
//                           backgroundColor: "red",
//                           borderColor: "red",
//                           data: [
//                               {
//                                   x: 10,
//                                   y: 20
//                               }, 
//                               {
//                                   x: 15,
//                                   y: 10
//                               },
//                               {
//                                   x: 20,
//                                   y: 15
//                               }
//                           ],

//                           fill: false,
//                         }]
//     },
//     options: {
//                 scales: {
//                     xAxes: [{
//                           ticks: {
//                               beginAtZero:true
//                           }
//                       }],
//                     yAxes: [{
//                         ticks: {
//                             beginAtZero:true
//                         }
//                     }]
//                 }
//             }
// });

// document.getElementById('addData').addEventListener('click', function() {
//             if (config.data.datasets.length > 0) {
//                 var month = MONTHS[config.data.labels.length % MONTHS.length];
//                 config.data.labels.push(month);

//                 config.data.datasets.forEach(function(dataset) {
//                     dataset.data.push(randomScalingFactor());
//                 });

//                 window.myLine.update();
//             }
//         });

// var myChart = new Chart(ctx, {
// type: 'bar',
// data: {
//     labels: ["Red", "Blue", "Yellow", "Green", "Purple", "Orange"],
//     datasets: [{
//         label: '# of Votes',
//         data: [12, 19, 3, 5, 2, 3],
//         backgroundColor: [
//             'rgba(255, 99, 132, 0.2)',
//             'rgba(54, 162, 235, 0.2)',
//             'rgba(255, 206, 86, 0.2)',
//             'rgba(75, 192, 192, 0.2)',
//             'rgba(153, 102, 255, 0.2)',
//             'rgba(255, 159, 64, 0.2)'
//         ],
//         borderColor: [
//             'rgba(255,99,132,1)',
//             'rgba(54, 162, 235, 1)',
//             'rgba(255, 206, 86, 1)',
//             'rgba(75, 192, 192, 1)',
//             'rgba(153, 102, 255, 1)',
//             'rgba(255, 159, 64, 1)'
//         ],
//         borderWidth: 1
//     }]
// },
// options: {
//     scales: {
//         yAxes: [{
//             ticks: {
//                 beginAtZero:true
//             }
//         }]
//     }
// }
// });


</script>
</body>
</html>